---
layout: null
---
{% assign proposal_posts = site.posts | where: "proposal", true %}
{% assign all_proposals = site.proposals | concat: proposal_posts %}
{
  "count": {{ all_proposals | size }},
  "debug": {
    "collections_available": [{% for coll in site.collections %}"{{ coll.label }}"{% unless forloop.last %},{% endunless %}{% endfor %}],
    "proposals_collection_count": {{ site.proposals | size }},
    "posts_with_proposal_flag": {{ proposal_posts | size }},
    "first_proposal_path": {% if all_proposals.first %}"{{ all_proposals.first.path }}"{% else %}null{% endif %}
  },
  "proposals": [
{% for proposal in all_proposals %}
    {
      "id": {{ forloop.index }},
      "title": {{ proposal.title | jsonify }},
      "author": {{ proposal.author | jsonify }},
      "category": {{ proposal.category | jsonify }},
      "status": {{ proposal.status | jsonify }},
      "description": {{ proposal.excerpt | strip_html | strip | jsonify }},
      "location": {
        "type": {{ proposal.location.type | jsonify }},
        "coordinates": {{ proposal.location.coordinates | jsonify }},
        "address": {{ proposal.location.address | jsonify }}
      },
      "budget": {{ proposal.budget | jsonify }},
      "dateProposed": {{ proposal.date | date: "%Y-%m-%d" | jsonify }},
      "url": {{ proposal.url | jsonify }},
      "content": {{ proposal.content | strip_html | strip | jsonify }}
    }{% unless forloop.last %},{% endunless %}
{% endfor %}
  ]
}